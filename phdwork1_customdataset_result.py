# -*- coding: utf-8 -*-
"""PHDWork1_CustomDataSet_Result.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Y-__8uEiDMvvQ5Zg_4KB_lYBOIkMQoTn
"""

# -*- coding: utf-8 -*-
"""mosquitobite.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1QqtOtNvMrkqopzWwROERWMwc4nuZGDno
"""

!git clone https://github.com/ultralytics/yolov5.git

# Commented out IPython magic to ensure Python compatibility.
# %cd yolov5/

!pip install -r requirements.txt

!/content/yolov5/weights/download_weights.sh

!python train.py --img 416 --batch 8 --epochs 50 --data coco128.yaml --weights yolov5s.pt --nosave --cache

!python test.py --weights /content/yolov5/runs/train/exp3/weights/last.pt --data coco128.yaml --img 416

import torch
from matplotlib import pyplot as plt
import numpy as np
import cv2

model = torch.hub.load('ultralytics/yolov5', 'custom', path='/content/yolov5/runs/train/exp3/weights/last.pt')

img='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQnr4zz-6f5QNNK2CAQNJaxH_y1UXvFw4wLb_ZYo3pkZGnIMyOgB2gQqGAMq9H2jwL8QBg&usqp=CAU'

results = model(img)

results.print()

# Commented out IPython magic to ensure Python compatibility.
# %matplotlib inline
plt.imshow(np.squeeze(results.render()))
plt.show()

# Commented out IPython magic to ensure Python compatibility.
# %load_ext tensorboard
# %tensorboard --logdir runs/train

!git clone https://github.com/ultralytics/yolov5.git

import torch
from matplotlib import pyplot as plt
import numpy as np
import cv2

model = torch.hub.load('ultralytics/yolov5', 'custom', path='/content/drive/MyDrive/Byte/lastF.pt')

img='/content/drive/MyDrive/Byte/595d386916160f344a8b4577.jpg'

results = model(img)

results.print()

# Commented out IPython magic to ensure Python compatibility.
# %matplotlib inline

# Commented out IPython magic to ensure Python compatibility.
# %matplotlib inline
plt.imshow(np.squeeze(results.render()))
plt.show()